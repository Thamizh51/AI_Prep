{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prep - {% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'navbar.css' %}?v=2">
    <link rel="stylesheet" href="{% static 'footer.css' %}?v=1">
    {% block css %}{% endblock %}
</head>

<body>

    <!-- Navigation Bar -->
    <nav class="navbar" id="navbar">
        <div class="container">
            <!-- Logo -->
            <a href="{% url 'home' %}" class="logo">
                <div class="logo-icon">
                    <!-- SVG Sparkle Icon for AI -->
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z" />
                    </svg>
                </div>
                AI <span>Prep</span>
            </a>

            <!-- Desktop Navigation Links -->
            <ul class="nav-links">
                <li><a href="{% url 'home' %}" class="nav-link">Home</a></li>
                <li><a href="{% url 'features' %}" class="nav-link">Features</a></li>
                <li><a href="{% url 'mock_interviews' %}" class="nav-link">Mock Interviews</a></li>
                <li><a href="{% url 'about' %}" class="nav-link">About</a></li>
                <li><a href="{% url 'contact' %}" class="nav-link">Contact</a></li>
            </ul>

            <!-- Desktop Buttons -->
            <div class="nav-buttons">
                {% if user.is_authenticated %}
                <a href="{% url 'logout' %}" class="btn btn-ghost logout-link">Log Out</a>
                <a href="{% url 'interview' %}" class="btn btn-primary">
                    Start Interview
                </a>
                {% else %}
                <a href="{% url 'login' %}" class="btn btn-ghost">Log In
                    <svg style="margin-left: 6px;" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                        <polyline points="12 5 19 12 12 19"></polyline>
                    </svg>
                </a>
                <a href="{% url 'signup' %}" class="btn btn-primary">Sign Up
                    <svg style="margin-left: 6px;" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                        <polyline points="12 5 19 12 12 19"></polyline>
                    </svg>
                </a>
                {% endif %}
            </div>

            <!-- Mobile Hamburger Button -->
            <button class="mobile-toggle" id="mobile-toggle" aria-label="Toggle navigation menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu (Slide-out) -->
    <div class="overlay" id="overlay"></div>
    <div class="mobile-menu" id="mobile-menu">
        <a href="{% url 'home' %}" class="mobile-link">Home</a>
        <a href="{% url 'features' %}" class="mobile-link">Features</a>
        <a href="{% url 'mock_interviews' %}" class="mobile-link">Mock Interviews</a>
        <a href="{% url 'about' %}" class="mobile-link">About</a>
        <a href="{% url 'contact' %}" class="mobile-link">Contact</a>

        {% if user.is_authenticated %}
        <a href="{% url 'interview' %}" class="mobile-link">Start Interview</a>
        <a href="{% url 'logout' %}" class="mobile-link logout-link">Log Out</a>
        {% else %}
        <a href="{% url 'login' %}" class="mobile-link">Log In</a>
        <a href="{% url 'signup' %}" class="mobile-link">Sign Up</a>
        {% endif %}
    </div>

    <main class="page-content">
        {% block content %}
        {% endblock %}
    </main>

    {% include 'base/footer.html' %}


    <!-- Logout Confirmation Modal -->
    <div class="modal-overlay" id="logout-modal">
        <div class="modal-content">
            <h3 class="modal-title">Confirm Logout</h3>
            <p class="modal-message">Are you sure you want to log out of your account?</p>
            <div class="modal-actions">
                <button class="btn-modal btn-cancel" id="cancel-logout">Cancel</button>
                <button class="btn-modal btn-confirm" id="confirm-logout">Log Out</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navbar = document.getElementById('navbar');
            const mobileToggle = document.getElementById('mobile-toggle');
            const mobileMenu = document.getElementById('mobile-menu');
            const overlay = document.getElementById('overlay');
            const currentLocation = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link, .mobile-link');

            // 0. Active Link Highlighting
            navLinks.forEach(link => {
                const linkPath = new URL(link.getAttribute('href'), window.location.origin).pathname;
                if (currentLocation === linkPath) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });

            // 1. Scroll Effect
            window.addEventListener('scroll', () => {
                if (window.scrollY > 20) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            });

            // 2. Mobile Menu Toggle
            function toggleMenu() {
                const isActive = mobileMenu.classList.contains('active');
                if (isActive) {
                    closeMenu();
                } else {
                    openMenu();
                }
            }

            function openMenu() {
                mobileMenu.classList.add('active');
                overlay.classList.add('active');
                mobileToggle.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeMenu() {
                mobileMenu.classList.remove('active');
                overlay.classList.remove('active');
                mobileToggle.classList.remove('active');
                document.body.style.overflow = '';
            }

            mobileToggle.addEventListener('click', toggleMenu);
            overlay.addEventListener('click', closeMenu);

            // 3. Close menu when any mobile link is clicked
            const allMobileLinks = document.querySelectorAll('.mobile-link, .logout-link');
            allMobileLinks.forEach(link => {
                link.addEventListener('click', () => {
                    closeMenu();
                });
            });

            // 4. Logout Confirmation Modal
            const logoutModal = document.getElementById('logout-modal');
            const cancelLogoutBtn = document.getElementById('cancel-logout');
            const confirmLogoutBtn = document.getElementById('confirm-logout');
            let logoutTargetUrl = '';

            function openLogoutModal(event) {
                event.preventDefault();
                logoutTargetUrl = event.currentTarget.href;
                logoutModal.classList.add('active');
            }

            function closeLogoutModal() {
                logoutModal.classList.remove('active');
                logoutTargetUrl = '';
            }

            cancelLogoutBtn.addEventListener('click', closeLogoutModal);

            confirmLogoutBtn.addEventListener('click', () => {
                if (logoutTargetUrl) {
                    window.location.href = logoutTargetUrl;
                }
            });

            logoutModal.addEventListener('click', (e) => {
                if (e.target === logoutModal) {
                    closeLogoutModal();
                }
            });

            const logoutLinks = document.querySelectorAll('.logout-link');
            logoutLinks.forEach(link => {
                link.addEventListener('click', openLogoutModal);
            });
        });
    </script>

    <style>
        @keyframes bounce {

            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0);
            }

            40% {
                transform: translateY(-10px);
            }

            60% {
                transform: translateY(-5px);
            }
        }
    </style>

    <script>
        /**
         * Toggles password visibility for a given input field.
         * @param {string} inputId - The ID of the password input field.
         * @param {HTMLElement} iconContainer - The container of the toggle icon.
         */
        function togglePassword(inputId, iconContainer) {
            const input = document.getElementById(inputId);
            const icon = iconContainer.querySelector('svg');

            if (!input || !icon) return;

            if (input.type === 'password') {
                input.type = 'text';
                // Switch to "Eye Off" icon (Lucide eye-off replacement)
                icon.innerHTML = `
                    <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/>
                    <path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/>
                    <path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/>
                    <line x1="2" x2="22" y1="2" y2="22"/>
                `;
            } else {
                input.type = 'password';
                // Switch to "Eye Open" icon (Lucide eye replacement)
                icon.innerHTML = `
                    <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
                    <circle cx="12" cy="12" r="3"/>
                `;
            }
        }
    </script>

    {% block scripts %}
    {% endblock %}
</body>

</html>